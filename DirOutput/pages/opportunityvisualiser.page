<apex:page standardController="Opportunity" extensions="OpportunityVisualizerController" sidebar="false" showHeader="false">
    <apex:form >
    <html>
        <head>
             <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet" media="screen"/>
             <link href="//getbootstrap.com/examples/signin/signin.css" rel="stylesheet" media="screen"/>
             <apex:outputText value="{!opportunity.closedate}" rendered="false"/> 
           <style type="text/css">
                table, th, td {
                                border: 1px solid black;
                                border-collapse: collapse;
                                font-family: Arial,Helvetica,sans-serif;
                                
                               
                }
                .table{
                    margin-bottom:0px;
                    
                    
                }
                .table>thead>tr>th, .table>tbody>tr>th, .table>tfoot>tr>th, .table>thead>tr>td, .table>tbody>tr>td, .table>tfoot>tr>td { padding: 0px;border-color:rgb(160,160,160);}
                
                
                .top-header{
                   background: white;
                  
                
                }
                
                .left-pane{
                    border-style: solid;
                    border-top-color: white !important;
                    border-bottom-color: white !important;
                    text-align: right;
                    width:11%;
                    
                }
                
                .deactivated{
                    background-color:rgb(242,242,242);color:rgb(172,172,173);
                
                }
                
                .activated{
                    background-color:rgb(255,255,255);color:#000000;
                }
                
                .green{
                    background-color: rgb(178,212,132);
                }
                
                .red{
                    background-color: rgb(248,106,110);
                }
                
            </style>
            
            
           

        </head>
        <body style="text-align:center;background-color:white;padding-top:0px;padding-bottom:0px;">
            <table class="table table-bordered" style="width:100%;border-top-style:hidden;border-left-style:hidden;border-right:none;">
                <!-- table header starts here --->
                <tr>
                    <td   style="background:white;border:white;">
                      &nbsp;&nbsp;
                    </td>
                    <td class="top-header" style="border-left:none;border-right:none;">
                        MQL
                    </td>
                    <td class="top-header" style="border-left:none;border-right:none;">
                        SAL
                   </td>
                   
                   <td class="top-header" style="border-left:none;border-right:none;">
                       Opportunity
                   </td>
                   <td class="top-header" style="border-left:none;border-right:none;">
                       Subscription
                   </td>
                   
                </tr>
                <!--- table header ends here--->
                <tr>
                    <td class="left-pane">
                        Owner &amp; Age &nbsp;
                    </td>
                    <td class="{!if(l==null,'deactivated','')}">
                      <!-- MQL Owner -->
                       <apex:outputPanel rendered="{!if(ownerOfMQL!=null ,true,false)}">{!ownerOfMQL} </apex:outputPanel>
                       <apex:outputPanel rendered="{!if(ownerOfMQL!=null && l.DaysInMQL__c!=null ,true,false)}"> -</apex:outputPanel>
                       <apex:outputPanel rendered="{!if(l.DaysInMQL__c!=null  ,true,false)}">  {!l.DaysInMQL__c} day<apex:outputText value="s" rendered="{!if(l.DaysInMQL__c>1 || l.DaysInMQL__c==0,true,false)}"></apex:outputText>  </apex:outputPanel>
                    </td>
                    <td class="{!if(l!=null && (l.Stage__c=='SAL' || l.Stage__c=='SQL' || l.Stage__c=='SDL' || opportunity.StageName=='Demo' || opportunity.StageName=='Proposal/Price Quote' || opportunity.StageName=='Negotiation/Review'),'activated','deactivated' )}">
                        <!--SAL Owner -->
                         
                         <apex:outputPanel rendered="{!if(ownerOfSAL!=null,true,false)}"> {!ownerOfSAL} </apex:outputPanel>
                         <apex:outputPanel rendered="{!if(ownerOfSAL!=null && l.DaysInSAL__c!=null ,true,false)}"> -</apex:outputPanel>
                         <apex:outputPanel rendered="{!if(l.DaysInSAL__c!=null ,true,false)}"> {!l.DaysInSAL__c} day<apex:outputText value="s" rendered="{!if(l.DaysInSAL__c>1 || l.DaysInSAL__c==0 ,true,false)}"></apex:outputText>  </apex:outputPanel>
                        </td>
                 
                    <td class="{!if(l.Stage__c=='SDL' || opportunity.StageName=='Waiting for approval' || opportunity.StageName=='Proposal/Price Quote' || opportunity.StageName=='Negotiation/Review' || opportunity.StageName=='Value Proposition' || opportunity.StageName='Closed Won' || Contains(opportunity.StageName,'Closed Lost'),'activated','deactivated' )}">
                        <!--Opportunity Owner --->
                        <apex:outputPanel rendered="{!if(opportunityOwner.Name!=null ,true,false)}"> {!opportunityOwner.Name} - &nbsp; </apex:outputPanel>
                           <!-- <apex:outputPanel rendered="{!if(opportunity.StageName!='Closed Won' || opportunity.StageName!='Closed Lost'  ,true,false)}"> {!TODAY () - DATEVALUE(opportunity.CreatedDate)} days</apex:outputPanel>
                                <apex:outputPanel rendered="{!if(opportunity.StageName=='Closed Won' || opportunity.StageName=='Closed Lost'  ,true,false)}"> {!TODAY () - o.CloseDate} days</apex:outputPanel> -->
                        <apex:outputText value="{!IF(BEGINS(opportunity.StageName,'Closed'),   o.CloseDate - DATEVALUE(opportunity.CreatedDate), DATEVALUE(opportunity.CreatedDate) - DATEVALUE(opportunity.CreatedDate))}"></apex:outputText> day <apex:outputText value="s" rendered="{!if(IF(BEGINS(opportunity.StageName,'Closed'), TODAY () - o.CloseDate, TODAY () - DATEVALUE(opportunity.CreatedDate))>1,true,false)}"></apex:outputText>
                        
                    </td>
                    <td class="{!if(sub==false,'deactivated','')}" style="border-right: solid rgb(160,160,160);">
                        <!-- Subscription Owner -->
                       <!-- <apex:outputPanel rendered="{!if(l.DaysInSDL__c!=null,true,false)}"> {!l.DaysInSDL__c} days </apex:outputPanel> -->
                       
                    </td>
                </tr>
                <tr>
                   <td class="left-pane">
                        Status/Stage &nbsp;
                    </td>
                    <td class="{!if(((l.Status=='Open' || l.Status=='Contacted' || l.Status=='Interested' || l.Status=='Qualified' || l.Status=='Converted') || (l.Rejected__c==true && l.Stage__c=='SRL') && (l.Stage__c='SAL'|| l.Stage__c='SQL' || l.Stage__c='MQL' ) )&& (!Contains(opportunity.StageName,'Closed Lost')),'green',if(l.Status=='Unresponsive' && l.Stage__c='SAL','red',if(l.Stage__c='SDL' || l.Stage__c='SRL' || Contains(opportunity.StageName,'Closed Lost') ,'red','deactivated')))}">
                        Open
                    </td>
                    <td>
                        <!--  inner table for SAL sub levels -->
                        <table style="width:100%;" class="table table-bordered">
                            <tr>
                                <td class="{!if(((l.Status=='Open' || l.Status=='Contacted' || l.Status=='Interested' || l.Status=='Qualified' || l.Status=='Converted') && (l.Stage__c='SAL'|| l.Stage__c='SQL' )) && (!Contains(opportunity.StageName,'Closed Lost')),'green',if(l.Status=='Unresponsive' && l.Stage__c='SAL','red',if(l.Stage__c='SDL' || Contains(Opportunity.StageName,'Closed Lost'),'red','deactivated')))}" style="border-top-style:hidden;border-left-style:hidden;border-bottom-style:hidden;">
                                    Open
                                </td>
                                <td class="{!if(((l.Status=='Contacted' || l.Status=='Interested' || l.Status=='Qualified' || l.Status=='Converted') && (l.Stage__c='SAL'|| l.Stage__c='SQL' || l.Status=='Converted')) && (!Contains(opportunity.StageName,'Closed Lost')),'green',if(l.Status=='Unresponsive' && l.Stage__c='SAL','red',if(l.Stage__c='SDL' || Contains(opportunity.StageName,'Closed Lost') ,'red','deactivated')))}" style="border-right-style:hidden;border-top-style:hidden;border-bottom-style:hidden;">
                                    Contacted
                                </td>
                                
                            </tr>
                        </table>
                        <!-- inner table ends -->
                    </td>
                    
                    <td>
                        <!--  inner table for opportunity sub levels -->
                        <table style="width:100%;" class="table table-bordered">
                            <tr>
                                <td class="{!if(opportunity.StageName='Created' || opportunity.StageName='Value Proposition' || opportunity.StageName='Demo' || opportunity.StageName='Project Postponed' || opportunity.StageName='Proposal/Price Quote' || opportunity.StageName='Negotiation/Review' || opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won','green', if(lostStageName='Value Proposition' || lostStageName='Demo' || lostStageName='Project Postponed' || lostStageName='Waiting for approval' || lostStageName='Proposal/Price Quote' || lostStageName='Negotiation/Review','red','deactivated'))}" style="border-top-style:hidden;border-left-style:hidden;border-right-style:solid;border-bottom-style:hidden;">
                                    Created
                                </td>
                                <td class="{!if(opportunity.StageName='Value Proposition' || opportunity.StageName='Demo' || opportunity.StageName='Project Postponed' || opportunity.StageName='Proposal/Price Quote' || opportunity.StageName='Negotiation/Review' ||  opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won','green', if(lostStageName='Value Proposition' || lostStageName='Demo' || lostStageName='Project Postponed' || lostStageName='Waiting for approval' || lostStageName='Proposal/Price Quote' || lostStageName='Negotiation/Review','red','deactivated'))}" style="border-top-style:hidden;border-right-style:solid;border-bottom-style:hidden;border-right-style:solid;">
                                    Value Proposition
                                </td>
                                <td class="{!if(opportunity.StageName='Demo' || opportunity.StageName='Project Postponed' || opportunity.StageName='Proposal/Price Quote' || opportunity.StageName='Negotiation/Review' || opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won' ,'green',if(lostStageName='Demo' || lostStageName='Project Postponed' || lostStageName='Proposal/Price Quote' || lostStageName='Negotiation/Review' || lostStageName='Waiting for approval','red','deactivated'))}" style="border-top-style:hidden;border-bottom-style:hidden;border-right-style:solid;">
                                    Demo
                                </td>
                                <td class="{!if(opportunity.StageName='Project Postponed' || opportunity.StageName='Proposal/Price Quote' || opportunity.StageName='Negotiation/Review' || opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won' ,'green',if(lostStageName='Project Postponed' || lostStageName='Proposal/Price Quote' || lostStageName='Negotiation/Review' || lostStageName='Waiting for approval','red','deactivated'))}" style="border-top-style:hidden;border-bottom-style:hidden;border-right-style:solid;">
                                    Project Postponed
                                </td>
                                <td class="{!if( opportunity.StageName='Proposal/Price Quote' || opportunity.StageName='Negotiation/Review' || opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won' ,'green',if(lostStageName='Proposal/Price Quote' || lostStageName='Negotiation/Review' || lostStageName='Waiting for approval','red','deactivated'))}" style="border-top-style:hidden;border-bottom-style:hidden;border-right-style:solid;">
                                    Proposal
                                </td>
                                <td class="{!if(opportunity.StageName='Negotiation/Review' || opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won'  ,'green',if(lostStageName='Negotiation/Review'|| lostStageName='Waiting for approval','red','deactivated'))}" style="border-top-style:hidden;border-bottom-style:hidden;">
                                    Negotiation
                                </td>
                                <td class="{!if(opportunity.StageName='Waiting for approval' || opportunity.StageName='Closed Won' ,'green',if(lostStageName='Negotiation/Review','red','deactivated'))}" style="border-top-style:hidden;border-bottom-style:hidden;">
                                    Waiting for approval
                                </td>
                                <td class="{!if(opportunity.StageName='Closed Won' ,'green','deactivated')}" style="border-top-style:hidden;border-right-style:hidden;border-bottom-style:hidden;">
                                    Won
                                </td>
                            </tr>
                            
                        </table>
                        <!-- inner table ends --> 
                    </td>
                    <td class="{!if(sub==false,'deactivated','')}" style="border-right: solid rgb(160,160,160);">
                        <!-- ID and MMR---> 
                    </td>
                </tr>
                <tr>
                   <td class="left-pane">
                       Rejection &nbsp;
                    </td>
                    <td class="{!if(l.Rejected__c==true && l.Stage__c=='SRL' && (mql==true || l.Status=='Nurture'),'red','deactivated')}">
                                    SRL    
                    </td>
                    <td>
                        <!--inner table for SAL rejection row -->
                        <table style="width:100%;" class="table table-bordered">
                            <tr>
                                
                                <td class="{!if(l.Status=='Unresponsive' && l.Stage__c='SAL','red','deactivated')}" style="border-left-style:hidden;border-bottom-style:hidden;border-top-style:hidden;">
                                    Unresponsive
                                </td>
                                <td class="{!if(l.Rejected__c==true && l.Stage__c=='SAL' && l.Status=='Unresponsive','red','deactivated')}" style="border-bottom-style:hidden;border-right-style:hidden;border-top-style:hidden;">
                                    SRL
                                </td>
                            </tr>
                        </table>
                        <!-- inner table ends-->
                    </td>
                    
                    
                    <td class="{!if(sub==false && (!CONTAINS(opportunity.StageName,'Closed Lost')),'deactivated',if(CONTAINS(opportunity.StageName,'Closed'),'red','deactivated'))}">
                        Lost
                    </td>
                    <td class="deactivated" style="border-right: solid rgb(160,160,160);">
                    </td>
                </tr>
            </table>
        </body>
    </html>
    </apex:form>
</apex:page>